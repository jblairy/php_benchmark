[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[program:frankenphp]
command=frankenphp run --config /app/docker/frankenphp/Caddyfile
directory=/app
user=www-data
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=1

[program:messenger-worker-1]
command=php /app/bin/console messenger:consume async --time-limit=3600 --memory-limit=256M --limit=1000 -vv
directory=/app
user=www-data
autostart=true
autorestart=true
stdout_logfile=/app/var/log/messenger-worker-1.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/app/var/log/messenger-worker-1.error.log
stderr_logfile_maxbytes=10MB
priority=10
numprocs=1
startretries=10
stopwaitsecs=30
stopsignal=TERM

[program:messenger-worker-2]
command=php /app/bin/console messenger:consume async --time-limit=3600 --memory-limit=256M --limit=1000 -vv
directory=/app
user=www-data
autostart=true
autorestart=true
stdout_logfile=/app/var/log/messenger-worker-2.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/app/var/log/messenger-worker-2.error.log
stderr_logfile_maxbytes=10MB
priority=10
numprocs=1
startretries=10
stopwaitsecs=30
stopsignal=TERM

[program:messenger-worker-3]
command=php /app/bin/console messenger:consume async --time-limit=3600 --memory-limit=256M --limit=1000 -vv
directory=/app
user=www-data
autostart=true
autorestart=true
stdout_logfile=/app/var/log/messenger-worker-3.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/app/var/log/messenger-worker-3.error.log
stderr_logfile_maxbytes=10MB
priority=10
numprocs=1
startretries=10
stopwaitsecs=30
stopsignal=TERM

[program:messenger-worker-4]
command=php /app/bin/console messenger:consume async --time-limit=3600 --memory-limit=256M --limit=1000 -vv
directory=/app
user=www-data
autostart=true
autorestart=true
stdout_logfile=/app/var/log/messenger-worker-4.log
stdout_logfile_maxbytes=10MB
stderr_logfile=/app/var/log/messenger-worker-4.error.log
stderr_logfile_maxbytes=10MB
priority=10
numprocs=1
startretries=10
stopwaitsecs=30
stopsignal=TERM

[group:messenger-workers]
programs=messenger-worker-1,messenger-worker-2,messenger-worker-3,messenger-worker-4
priority=999
